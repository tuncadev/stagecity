jQuery(document).ready(function (n) {
	var t = civi_candidate_review_vars.ajax_url;
	var a = n(".candidate-review-details");
	a.find("input:file").change(function () {
		n(".fileList span").remove();
		for (var e = 0; e < this.files.length; e++) {
			var a = this.files[e].name;
			n(".fileList").append("<span>" + a + "</span>");
		}
	});
	a.find(".entry-nav .reply").on("click", function (e) {
		e.preventDefault();
		n(".author-review").removeClass("active");
		n(".author-review .form-reply").html("");
		var a = n(this);
		var r = n(".duplicate-form-reply").html();
		var i = a.parents(".author-review").find(".form-reply").data("id");
		n(".add-new-review").hide();
		a.parents(".author-review").addClass("active");
		a.parents(".author-review").find(".form-reply").html(r);
		a.parents(".author-review")
			.find('.form-reply input[name="comment_id"]')
			.val(i);
	});
	n("body").on(
		"click",
		".form-reply .civi-submit-candidate-reply",
		function (e) {
			e.preventDefault();
			var a = n(this);
			var r = a.parents("form");
			var i = r.find("textarea").val();
			if (i == "") {
				r.find("#message-error").fadeIn();
			} else {
				r.find("#message-error").fadeOut();
				n.ajax({
					type: "POST",
					url: t,
					data: r.serialize(),
					dataType: "json",
					beforeSend: function () {
						a.attr("disabled", true);
						a.children("i").remove();
						a.append('<i class="fa-left fal fa-spinner fa-spin large"></i>');
					},
					success: function () {
						window.location.reload();
					},
					complete: function () {
						a.children("i").removeClass("fal fa-spinner fa-spin large");
						a.children("i").addClass("fa fa-check");
					},
				});
			}
		}
	);
	n("body").on("click", ".cancel-reply", function (e) {
		e.preventDefault();
		a.find(".author-review").removeClass("active");
		a.find(".author-review .form-reply").html("");
		a.find(".add-new-review").show();
	});
	n.validator.setDefaults({ debug: true, success: "valid" });
	if (userLocale == "en") {	var nrequired = "This field is required" } else { var nrequired = "This field is required" }
	n(".reviewForm").validate({
		rules: { message: { required: true } },
		messages: { message: { required: nrequired } },
		errorPlacement: function (e, a) {
			if (a.is(":radio")) {
				e.appendTo(a.parents("fieldset"));
			} else {
				e.insertAfter(a);
			}
		},
		submitHandler: function (e) {
			var a = n(".reviewForm").find(".civi-submit-candidate-rating");
			var r = n(".reviewForm");
			var i = false;
			if (window.FormData) {
				i = new FormData(r[0]);
			}
			n.ajax({
				type: "POST",
				url: t,
				data: i ? i : r.serialize(),
				enctype: "multipart/form-data",
				dataType: "json",
				processData: false,
				contentType: false,
				beforeSend: function () {
					a.children("i").remove();
					a.append('<i class="fa-left fal fa-spinner fa-spin large"></i>');
				},
				success: function (e) {
					window.location.reload();
				},
				complete: function () {
					a.children("i").removeClass("fal fa-spinner fa-spin large");
					a.children("i").addClass("fa fa-check");
				},
			});
		},
	});
});
